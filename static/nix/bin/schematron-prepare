#!/bin/sh

if [ ! $2 ]; then
  echo "Usage: $(basename $0) [source file] [target file]"
  exit 1
fi

export PDK_PATH=$(dirname $(dirname "$0"))
export JAVA_HOME=$PDK_PATH/lib/corretto
export SAXON_PATH=$PDK_PATH/lib/saxon/saxon.jar

$JAVA_HOME/bin/java ${JAVA_OPTS:-} -cp $SAXON_PATH net.sf.saxon.Transform \
  -xsl:$PDK_PATH/lib/schematron/iso_dsdl_include.xsl \
  -s:$1 \
| $JAVA_HOME/bin/java ${JAVA_OPTS:-} -cp $SAXON_PATH net.sf.saxon.Transform \
  -xsl:$PDK_PATH/lib/schematron/iso_abstract_expand.xsl \
  -s:- \
  -o:$2
